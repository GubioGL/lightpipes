

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Examples. &mdash; LightPipes for Python 2.0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Computer practical." href="computerprac.html" />
    <link rel="prev" title="5. Manual." href="manual.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> LightPipes for Python
          

          
            
            <img src="_static/front.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction.</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">2. Installation.</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">3. Support.</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-reference.html">4. Command Reference.</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual.html">5. Manual.</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Examples.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#interference-examples">6.1. Interference examples.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#young-s-experiment">6.1.1. Young’s experiment.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#michelson-interferometer">6.1.2. Michelson interferometer.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interference-of-a-doughnut-laser-beam-collinear-beams">6.1.3. Interference of a doughnut laser beam: collinear beams.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interference-of-a-doughnut-laser-beam-tilted-beams">6.1.4. Interference of a doughnut laser beam: tilted beams.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#diffraction-examples">6.2. Diffraction examples.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#diffraction-from-a-circular-aperture">6.2.1. Diffraction from a circular aperture.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spot-of-poisson">6.2.2. Spot of Poisson.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#non-diffractive-bessel-beam">6.3. Non-diffractive Bessel beam.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#from-poisson-spot-to-a-non-diffractive-bessel-beam">6.3.1. From Poisson spot to a non-diffractive Bessel beam.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#collimating-the-edge-waves-with-a-lens">6.3.1.1. Collimating the edge waves with a lens.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#generation-of-a-bessel-beam-with-a-lens-and-an-annular-slit">6.3.2. Generation of a Bessel beam with a lens and an annular slit.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generation-of-a-bessel-beam-with-an-axicon">6.3.3. Generation of a Bessel beam with an axicon.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#laser-examples">6.4. Laser examples.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hermite-gauss-modes">6.4.1. Hermite Gauss modes.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#laguerre-gauss-modes">6.4.2. Laguerre Gauss modes.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#laguerre-doughnut-modes">6.4.3. Laguerre doughnut modes.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#laser-simulation-stable-laser-resonator">6.4.4. Laser simulation, stable laser resonator.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unstable-laser-resonator">6.4.5. Unstable laser resonator.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transformation-of-a-fundamental-gauss-mode-into-a-doughnut-mode-with-a-spiral-phase-plate">6.4.6. Transformation of a fundamental Gauss mode into a doughnut mode with a spiral phase plate.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phase-recovery">6.5. Phase recovery.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#phase-recovery-using-gerchberg-saxton-iteration">6.5.1. Phase recovery using Gerchberg Saxton iteration.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#zernike-aberration">6.6. Zernike aberration.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#radial-shear-interferometer">6.6.1. Radial shear interferometer.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#graded-index-media-grin">6.7. Graded index media GRIN.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#demonstration-of-a-grin-lens">6.7.1. Demonstration of a GRIN lens.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#young-s-experiment-with-grin-lens">6.7.2. Young’s experiment with GRIN lens.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#propagation-in-a-lens-like-absorptive-medium">6.7.3. Propagation in a lens-like, absorptive medium.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fourier-optics">6.8. Fourier optics.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pattern-recognition">6.8.1. Pattern recognition.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="computerprac.html">7. Computer practical.</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">LightPipes for Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">6. </span>Examples.</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<h1><span class="section-number">6. </span>Examples.<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="interference-examples">
<h2><span class="section-number">6.1. </span>Interference examples.<a class="headerlink" href="#interference-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="young-s-experiment">
<span id="index-0"></span><h3><span class="section-number">6.1.1. </span>Young’s experiment.<a class="headerlink" href="#young-s-experiment" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="kn">as</span> <span class="nn">mpimg</span>
<span class="n">LPversion</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Young&#39;s experiment.</span>
<span class="sd">    Two holes with radii, R, separated by, d, in a screen are illuminated by a plane wave. The interference pattern</span>
<span class="sd">    at a distance, z, behind the screen is calculated.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="k">print</span><span class="p">(</span><span class="n">LPversion</span><span class="p">)</span>
<span class="n">wavelength</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">um</span>
<span class="n">size</span><span class="o">=</span><span class="mf">20.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">500</span>
<span class="n">z</span><span class="o">=</span><span class="mi">50</span><span class="o">*</span><span class="n">cm</span>
<span class="n">R</span><span class="o">=</span><span class="mf">0.3</span><span class="o">*</span><span class="n">mm</span>
<span class="n">d</span><span class="o">=</span><span class="mf">1.2</span><span class="o">*</span><span class="n">mm</span>

<span class="n">img</span><span class="o">=</span><span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Young.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Interference/Young.py">Source code</a>, <a class="reference external" href="./Examples/Interference/Young_00_00.png">png</a>, <a class="reference external" href="./Examples/Interference/Young_00_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Interference/Young_00_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Young_00_00.png" src="_images/Young_00_00.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">F1</span><span class="o">=</span><span class="n">CircAperture</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="o">-</span><span class="n">d</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">CircAperture</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">d</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>    
<span class="n">F</span><span class="o">=</span><span class="n">BeamMix</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;intensity pattern&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Interference/Young_01_00.png">png</a>, <a class="reference external" href="./Examples/Interference/Young_01_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Interference/Young_01_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Young_01_00.png" src="_images/Young_01_00.png" />
</div>
</div>
<div class="section" id="michelson-interferometer">
<h3><span class="section-number">6.1.2. </span>Michelson interferometer.<a class="headerlink" href="#michelson-interferometer" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate" id="index-1"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="kn">as</span> <span class="nn">mpimg</span>

<span class="n">wavelength</span><span class="o">=</span><span class="mf">632.8</span><span class="o">*</span><span class="n">nm</span> <span class="c1">#wavelength of HeNe laser</span>
<span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span> <span class="c1"># size of the grid</span>
<span class="n">N</span><span class="o">=</span><span class="mi">300</span> <span class="c1"># number (NxN) of grid pixels</span>
<span class="n">R</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">mm</span> <span class="c1"># laser beam radius</span>
<span class="n">z1</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># length of arm 1</span>
<span class="n">z2</span><span class="o">=</span><span class="mi">7</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># length of arm 2</span>
<span class="n">z3</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># distance laser to beamsplitter</span>
<span class="n">z4</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># distance beamsplitter to screen</span>
<span class="n">Rbs</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># reflection beam splitter</span>
<span class="n">tx</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">mrad</span><span class="p">;</span> <span class="n">ty</span><span class="o">=</span><span class="mf">0.0</span><span class="o">*</span><span class="n">mrad</span> <span class="c1"># tilt of mirror 1</span>
<span class="n">f</span><span class="o">=</span><span class="mi">50</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># focal length of positive lens</span>

<span class="n">img</span><span class="o">=</span><span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Michelson.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Interference/Michelson.py">Source code</a>, <a class="reference external" href="./Examples/Interference/Michelson_00_00.png">png</a>, <a class="reference external" href="./Examples/Interference/Michelson_00_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Interference/Michelson_00_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Michelson_00_00.png" src="_images/Michelson_00_00.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Generate a weak converging laser beam using a weak positive lens:</span>
<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1">#F=GaussBeam(F, R)</span>
<span class="c1">#F=GaussHermite(F,R,0,0,1) #new style</span>
<span class="c1">#F=GaussHermite(F,R) #new style</span>
<span class="n">F</span><span class="o">=</span><span class="n">GaussHermite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="c1">#old style</span>
<span class="n">F</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="c1">#Propagate to the beamsplitter:</span>
<span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z3</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="c1">#Split the beam and propagate to mirror #2:</span>
<span class="n">F2</span><span class="o">=</span><span class="n">IntAttenuator</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Rbs</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>

<span class="c1">#Introduce tilt and propagate back to the beamsplitter:</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Tilt</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">IntAttenuator</span><span class="p">(</span><span class="n">Rbs</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>

<span class="c1">#Split off the second beam and propagate to- and back from the mirror #1:</span>
<span class="n">F10</span><span class="o">=</span><span class="n">IntAttenuator</span><span class="p">(</span><span class="n">Rbs</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F1</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z1</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">F10</span><span class="p">)</span>
<span class="n">F1</span><span class="o">=</span><span class="n">IntAttenuator</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Rbs</span><span class="p">,</span><span class="n">F1</span><span class="p">)</span>

<span class="c1">#Recombine the two beams and propagate to the screen:</span>
<span class="n">F</span><span class="o">=</span><span class="n">BeamMix</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z4</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;intensity pattern&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Interference/Michelson_01_00.png">png</a>, <a class="reference external" href="./Examples/Interference/Michelson_01_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Interference/Michelson_01_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Michelson_01_00.png" src="_images/Michelson_01_00.png" />
</div>
</div>
<div class="section" id="interference-of-a-doughnut-laser-beam-collinear-beams">
<h3><span class="section-number">6.1.3. </span>Interference of a doughnut laser beam: collinear beams.<a class="headerlink" href="#interference-of-a-doughnut-laser-beam-collinear-beams" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Doughnut_collinear.py</span>

<span class="sd">    Interference of a collinear zero order beam with a  Laguerre-Gauss</span>
<span class="sd">    doughnut beam.</span>
<span class="sd">    The interferometer could be a Michelson instrument.</span>

<span class="sd">    cc Fred van Goor, May 2020.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">if</span> <span class="n">LPversion</span> <span class="o">&lt;</span> <span class="s2">&quot;2.0.0&quot;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;You need to upgrade LightPipes to run this script.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;Type at a terminal prompt: $ pip install --upgrade LightPipes&#39;</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">wavelength</span><span class="o">=</span><span class="mf">632.8</span><span class="o">*</span><span class="n">nm</span> <span class="c1">#wavelength of HeNe laser</span>
<span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span> <span class="c1"># size of the grid</span>
<span class="n">N</span><span class="o">=</span><span class="mi">300</span> <span class="c1"># number (NxN) of grid pixels</span>
<span class="n">R</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">mm</span> <span class="c1"># laser beam radius</span>

<span class="n">z1</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># length of path 1</span>
<span class="n">z2</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># length of path 2</span>
<span class="n">dz</span><span class="o">=</span><span class="mf">0.05</span><span class="o">*</span><span class="n">wavelength</span> <span class="c1">#step of path 2</span>

<span class="c1">#initiate plots:</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">_axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">14.0</span><span class="p">,</span><span class="mf">7.0</span><span class="p">))</span>

<span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Interference of a collinear doughnut- and a zero-order Gaussian beam.&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
<span class="sa">r</span><span class="s1">&#39;Rotating spot due to Michelson arm length scan.&#39;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">_axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">F1</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">doughnut</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#beam 1: doughnut  Laguerre-Gauss</span>
<span class="n">F1</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="n">F1</span><span class="p">)</span> <span class="c1">#propagate path 1</span>

<span class="n">F2</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="c1">#beam 2: TEM00 Gauss</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span> <span class="c1">#propagate path 2</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">23</span><span class="p">):</span>
    <span class="n">F2</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">dz</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span> <span class="c1">#step path 2</span>
    <span class="n">F</span><span class="o">=</span><span class="n">BeamMix</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span> <span class="c1">#add the two beams</span>
    <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="c1">#intensity at the observing screen</span>
    <span class="c1">#make the plots:</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$z/\lambda = $&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;{:4.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">dz</span><span class="o">/</span><span class="n">wavelength</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;LightPipes for Python,&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;Doughnut-mode-interference-collinear.py&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$\lambda = {:4.1f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wavelength</span><span class="o">/</span><span class="n">nm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $nm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$size = {:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $mm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$N = {:4d}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$R = {:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $mm$&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$z_1 = {:4.1f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $cm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$z_2 = {:4.1f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z2</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $cm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$\Delta{z} = &#39;</span> <span class="o">+</span> <span class="s1">&#39;{:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dz</span><span class="o">/</span><span class="n">wavelength</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $\lambda$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;${\copyright}$ Fred van Goor, May 2020&#39;</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#show the results</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Interference/Doughnut_collinear.py">Source code</a>, <a class="reference external" href="./Examples/Interference/Doughnut_collinear.png">png</a>, <a class="reference external" href="./Examples/Interference/Doughnut_collinear.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Interference/Doughnut_collinear.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Doughnut_collinear.png" src="_images/Doughnut_collinear.png" />
</div>
</div>
<div class="section" id="interference-of-a-doughnut-laser-beam-tilted-beams">
<h3><span class="section-number">6.1.4. </span>Interference of a doughnut laser beam: tilted beams.<a class="headerlink" href="#interference-of-a-doughnut-laser-beam-tilted-beams" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Doughnut_tilt.py</span>

<span class="sd">    Interference of a non-collinear zero order beam with a  Laguerre-Gauss</span>
<span class="sd">    doughnut beam.</span>
<span class="sd">    The interferometer could be a Michelson or a Mach Zehnder instrument.</span>

<span class="sd">    cc Fred van Goor, may 2020</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="k">if</span> <span class="n">LPversion</span> <span class="o">&lt;</span> <span class="s2">&quot;2.0.0&quot;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;You need to upgrade LightPipes to run this script.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;Type at a terminal prompt: $ pip install --upgrade LightPipes&#39;</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">wavelength</span><span class="o">=</span><span class="mf">632.8</span><span class="o">*</span><span class="n">nm</span> <span class="c1">#wavelength of HeNe laser</span>
<span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span> <span class="c1"># size of the grid</span>
<span class="n">N</span><span class="o">=</span><span class="mi">300</span> <span class="c1"># number (NxN) of grid pixels</span>
<span class="n">w0</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">mm</span> <span class="c1"># laser beam radius (in waist)</span>
<span class="n">z1</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># length of arm 1</span>
<span class="n">z2</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="n">cm</span> <span class="c1"># length of arm 2</span>
<span class="n">tx</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">mrad</span> <span class="c1"># tilt of mirror 1</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">F1</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">doughnut</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">xshift</span><span class="o">=-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">mm</span><span class="p">)</span>
<span class="n">Phi</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">tx</span><span class="o">=</span><span class="n">tx</span><span class="p">)</span>
<span class="n">F1</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="n">F1</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">BeamMix</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>


<span class="c1">#initiate plots:</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">))</span>
<span class="c1">#axs=_axs.flatten()</span>
<span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Interference of a doughnut- and a tilted zero-order Gaussian beam.&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
<span class="sa">r</span><span class="s1">&#39;Forked interference pattern (Michelson interferometer) due to helical phase of doughnut mode.&#39;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Interference pattern&#39;</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Phase distribution&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;of the doughnut beam.&#39;</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;LightPipes for Python,&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;Doughnut-mode-interference-tilt.py&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$\lambda = {:4.1f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wavelength</span><span class="o">/</span><span class="n">nm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $nm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$size = {:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $mm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$N = {:4d}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$w_0 = {:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w0</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $mm$&#39;</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$z_1 = {:4.1f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z1</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $cm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$z_2 = {:4.1f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z2</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $cm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$t_x = &#39;</span> <span class="o">+</span> <span class="s1">&#39;{:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tx</span><span class="o">/</span><span class="n">mrad</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $mrad$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;${\copyright}$ Fred van Goor, May 2020&#39;</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.18</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Interference/Doughnut_tilt.py">Source code</a>, <a class="reference external" href="./Examples/Interference/Doughnut_tilt.png">png</a>, <a class="reference external" href="./Examples/Interference/Doughnut_tilt.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Interference/Doughnut_tilt.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Doughnut_tilt.png" src="_images/Doughnut_tilt.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="diffraction-examples">
<h2><span class="section-number">6.2. </span>Diffraction examples.<a class="headerlink" href="#diffraction-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="diffraction-from-a-circular-aperture">
<span id="index-2"></span><h3><span class="section-number">6.2.1. </span>Diffraction from a circular aperture.<a class="headerlink" href="#diffraction-from-a-circular-aperture" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">wavelength</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">um</span>
<span class="n">size</span><span class="o">=</span><span class="mf">25.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">500</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">CircAperture</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">cm</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Diffraction/RoundHole.py">Source code</a>, <a class="reference external" href="./Examples/Diffraction/RoundHole.png">png</a>, <a class="reference external" href="./Examples/Diffraction/RoundHole.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Diffraction/RoundHole.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/RoundHole.png" src="_images/RoundHole.png" />
</div>
</div>
<div class="section" id="spot-of-poisson">
<span id="index-3"></span><h3><span class="section-number">6.2.2. </span>Spot of Poisson.<a class="headerlink" href="#spot-of-poisson" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">wavelength</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">um</span>
<span class="n">size</span><span class="o">=</span><span class="mf">25.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">500</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">CircScreen</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="mi">0</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="mi">0</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">cm</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Poisson&#39;s spot&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Diffraction/Poisson.py">Source code</a>, <a class="reference external" href="./Examples/Diffraction/Poisson.png">png</a>, <a class="reference external" href="./Examples/Diffraction/Poisson.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Diffraction/Poisson.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Poisson.png" src="_images/Poisson.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="non-diffractive-bessel-beam">
<h2><span class="section-number">6.3. </span>Non-diffractive Bessel beam.<a class="headerlink" href="#non-diffractive-bessel-beam" title="Permalink to this headline">¶</a></h2>
<p id="index-4">A Bessel beam has the interesting property that it does not diffract and that it keeps its shape
over large distances. Several meters, depending on parameters, can be realized. Applications of Bessel beams
take advantage of the very large size of the focus, which cannot be obtained using lenses or mirrors.
For example generation of a long narrow plasma channel can be realized using a high-power
laser beam converted into a Bessel beam by an axicon lens.</p>
<p>Besides an axicon, a combination of an annular slit and a positive lens or concave mirror can be used in staed.
In the following example a Poisson spot is generated by illuminating a circular disk by a plane mono-chromatic beam.
The disk is positioned in the primary focus of a positive lens so that the waves originating from the edge of teh disk will be collimated.
By blocking the rest of the incoming beam only the edge waves remain which results in a
non-diffracting Bessel beam.</p>
<p>reference: J.Durnin, “Exact solutions for nondiffracting beams. I. The scalar theory.”
JOSA A, Vol. 4, Issue 4, pp. 651-654 (1987)</p>
<div class="section" id="from-poisson-spot-to-a-non-diffractive-bessel-beam">
<h3><span class="section-number">6.3.1. </span>From Poisson spot to a non-diffractive Bessel beam.<a class="headerlink" href="#from-poisson-spot-to-a-non-diffractive-bessel-beam" title="Permalink to this headline">¶</a></h3>
<p>The waves originating from Huygens point-sources at the edge of the disk can be considered as a
collection of spherical waves which are all in phase because the disk is illuminated by a monochromatic plane wave.
Each spherical wave has the same amplitude as well. As a result these waves interfere constructively
to a Poisson spot near the axis. It can be shown that the intensity distribution is approximately given by:</p>
<p><span class="math notranslate nohighlight">\(I(r,z) \approx I_0 J_0 ^2 ( \frac{2 \pi  \alpha r}{ \lambda } )\)</span></p>
<p>with:</p>
<p><span class="math notranslate nohighlight">\(\alpha = \frac{a}{r}\)</span> is the angle of the wavefront near the axis,
<span class="math notranslate nohighlight">\(2a\)</span> is the diameter of the disk</p>
<p>The width of the beam is given by:</p>
<p><span class="math notranslate nohighlight">\(w(z)=\frac{2.44}{ \pi } \frac{ \lambda z}{a}\)</span></p>
<p>and is proportional to the distance, z.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="kn">as</span> <span class="nn">mpimg</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">img</span><span class="o">=</span><span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;bessel1.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Spot of Poisson&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit1.py">Source code</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit1_00_00.png">png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit1_00_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit1_00_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/BesselAnnularSlit1_00_00.png" src="_images/BesselAnnularSlit1_00_00.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wavelength</span><span class="o">=</span><span class="mf">1000.0</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>

<span class="n">N2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ZoomFactor</span><span class="o">=</span><span class="mi">10</span>
<span class="n">NZ</span><span class="o">=</span><span class="n">N2</span><span class="o">/</span><span class="n">ZoomFactor</span>

<span class="n">a</span><span class="o">=</span><span class="mf">1.5</span><span class="o">*</span><span class="n">mm</span>
<span class="n">z_start</span><span class="o">=</span><span class="mf">0.001</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span> <span class="n">z_end</span><span class="o">=</span> <span class="mi">150</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span>
<span class="n">steps</span><span class="o">=</span><span class="mi">11</span><span class="p">;</span>
<span class="n">delta_z</span><span class="o">=</span><span class="p">(</span><span class="n">z_end</span><span class="o">-</span><span class="n">z_start</span><span class="p">)</span><span class="o">/</span><span class="n">steps</span>
<span class="n">z</span><span class="o">=</span><span class="n">z_start</span>
<span class="c1">#x=[]</span>
<span class="c1">#for i in range(1,N):</span>
<span class="c1">#   x.append((-size/2 + i*size/N)/mm)</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mf">3.5</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">CircScreen</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="n">w0</span><span class="o">=</span><span class="mf">2.44</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">wavelength</span><span class="o">/</span><span class="n">a</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">w</span><span class="o">=</span><span class="n">w0</span><span class="o">*</span><span class="n">z</span>

    <span class="c1">#y=[]</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="n">delta_z</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="c1">#for j in range(1,N):</span>
    <span class="c1">#    y.append(I[N2][j])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>

    <span class="n">s</span><span class="o">=</span><span class="s1">&#39;z= </span><span class="si">%3.1f</span><span class="s1"> m </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;width = </span><span class="si">%3.2f</span><span class="s1"> mm&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="c1">#plt.plot(x,y)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">N2</span><span class="o">-</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">+</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">-</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">+</span><span class="n">NZ</span><span class="p">])</span>
    <span class="c1">#plt.axis([-1, 1, 0,1])</span>
    <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">+</span><span class="n">delta_z</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit1_01_00.png">png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit1_01_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit1_01_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/BesselAnnularSlit1_01_00.png" src="_images/BesselAnnularSlit1_01_00.png" />
</div>
<div class="section" id="collimating-the-edge-waves-with-a-lens">
<h4><span class="section-number">6.3.1.1. </span>Collimating the edge waves with a lens.<a class="headerlink" href="#collimating-the-edge-waves-with-a-lens" title="Permalink to this headline">¶</a></h4>
<p>When the disk is placed in the primary focus of a postive lens,the spherical waves are collimated and
the angle, <span class="math notranslate nohighlight">\(\alpha\)</span> remains constant. As a result the beam does not diverge anymore. Ofcourse
the light passing the disk at larger distances from the edge will be focussed as well by the lens and
will disturb the Bessel beam. This light can easily been blocked with an extra aperture
surrounding the disk resulting in an annular slit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="kn">as</span> <span class="nn">mpimg</span>

<span class="n">img</span><span class="o">=</span><span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;bessel2.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Spot of Poisson -&gt; Bessel beam with lens&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit2.py">Source code</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit2_00_00.png">png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit2_00_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit2_00_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/BesselAnnularSlit2_00_00.png" src="_images/BesselAnnularSlit2_00_00.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wavelength</span><span class="o">=</span><span class="mf">1000.0</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>

<span class="n">N2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ZoomFactor</span><span class="o">=</span><span class="mi">10</span>
<span class="n">NZ</span><span class="o">=</span><span class="n">N2</span><span class="o">/</span><span class="n">ZoomFactor</span>

<span class="n">a</span><span class="o">=</span><span class="mf">1.5</span><span class="o">*</span><span class="n">mm</span>
<span class="n">f</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="n">mm</span>
<span class="n">z_start</span><span class="o">=</span><span class="mf">0.001</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span> <span class="n">z_end</span><span class="o">=</span> <span class="mi">150</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span>
<span class="n">steps</span><span class="o">=</span><span class="mi">11</span><span class="p">;</span>
<span class="n">delta_z</span><span class="o">=</span><span class="p">(</span><span class="n">z_end</span><span class="o">-</span><span class="n">z_start</span><span class="p">)</span><span class="o">/</span><span class="n">steps</span>
<span class="n">z</span><span class="o">=</span><span class="n">z_start</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mf">3.5</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">CircScreen</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
<span class="n">F</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">steps</span><span class="p">):</span> 
    <span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="n">delta_z</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="n">s</span><span class="o">=</span><span class="s1">&#39;z= </span><span class="si">%3.1f</span><span class="s1"> m&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">N2</span><span class="o">-</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">+</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">-</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">+</span><span class="n">NZ</span><span class="p">])</span>
    <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">+</span><span class="n">delta_z</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit2_01_00.png">png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit2_01_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit2_01_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/BesselAnnularSlit2_01_00.png" src="_images/BesselAnnularSlit2_01_00.png" />
</div>
</div>
</div>
<div class="section" id="generation-of-a-bessel-beam-with-a-lens-and-an-annular-slit">
<h3><span class="section-number">6.3.2. </span>Generation of a Bessel beam with a lens and an annular slit.<a class="headerlink" href="#generation-of-a-bessel-beam-with-a-lens-and-an-annular-slit" title="Permalink to this headline">¶</a></h3>
<p>By positioning an aperture around the disk a non-difracting Bessel beam is generated over a distance given by
the ‘overlap area’. From geometric optics this distance can be estimated by:</p>
<p><span class="math notranslate nohighlight">\(z_{max}=\frac{Df}{a}\)</span>, where <span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(f\)</span> are the diameter and focallength of the lens respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="kn">as</span> <span class="nn">mpimg</span>

<span class="n">img</span><span class="o">=</span><span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;bessel3.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bessel beam with annular slit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit3.py">Source code</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit3_00_00.png">png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit3_00_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit3_00_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/BesselAnnularSlit3_00_00.png" src="_images/BesselAnnularSlit3_00_00.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wavelength</span><span class="o">=</span><span class="mf">1000.0</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>

<span class="n">N2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ZoomFactor</span><span class="o">=</span><span class="mi">10</span>
<span class="n">NZ</span><span class="o">=</span><span class="n">N2</span><span class="o">/</span><span class="n">ZoomFactor</span>

<span class="n">a</span><span class="o">=</span><span class="mf">1.5</span><span class="o">*</span><span class="n">mm</span>
<span class="n">f</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="n">mm</span>
<span class="n">z_start</span><span class="o">=</span><span class="mf">0.001</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span> <span class="n">z_end</span><span class="o">=</span> <span class="mi">150</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span>
<span class="n">steps</span><span class="o">=</span><span class="mi">11</span><span class="p">;</span>
<span class="n">delta_z</span><span class="o">=</span><span class="p">(</span><span class="n">z_end</span><span class="o">-</span><span class="n">z_start</span><span class="p">)</span><span class="o">/</span><span class="n">steps</span>
<span class="n">z</span><span class="o">=</span><span class="n">z_start</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mf">3.5</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">CircScreen</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">CircAperture</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
<span class="n">F</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">steps</span><span class="p">):</span> 
    <span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="n">delta_z</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="n">s</span><span class="o">=</span><span class="s1">&#39;z= </span><span class="si">%3.1f</span><span class="s1"> m&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">N2</span><span class="o">-</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">+</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">-</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">+</span><span class="n">NZ</span><span class="p">])</span>
    <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">+</span><span class="n">delta_z</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit3_01_00.png">png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit3_01_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAnnularSlit3_01_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/BesselAnnularSlit3_01_00.png" src="_images/BesselAnnularSlit3_01_00.png" />
</div>
</div>
<div class="section" id="generation-of-a-bessel-beam-with-an-axicon">
<h3><span class="section-number">6.3.3. </span>Generation of a Bessel beam with an axicon.<a class="headerlink" href="#generation-of-a-bessel-beam-with-an-axicon" title="Permalink to this headline">¶</a></h3>
<p>Using an annular slit is of course not very efficient because most of the incoming (laser) beam is not used.
A much more efficient way to generate a Bessel beam is the use of an axicon. With such an element
in principle all the incoming light is converted.
Although all the light is converted most applications are only interacting with the central lobe of the beam, which only carries
a small fraction of the total beam power.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="kn">as</span> <span class="nn">mpimg</span>

<span class="n">img</span><span class="o">=</span><span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;bessel_axicon.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bessel beam with axicon&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/BesselBeam/BesselAxicon.py">Source code</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAxicon_00_00.png">png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAxicon_00_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAxicon_00_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/BesselAxicon_00_00.png" src="_images/BesselAxicon_00_00.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wavelength</span><span class="o">=</span><span class="mf">1000.0</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1000</span>

<span class="n">N2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ZoomFactor</span><span class="o">=</span><span class="mi">10</span>
<span class="n">NZ</span><span class="o">=</span><span class="n">N2</span><span class="o">/</span><span class="n">ZoomFactor</span>

<span class="n">phi</span><span class="o">=</span><span class="mf">179.7</span><span class="o">/</span><span class="mi">180</span><span class="o">*</span><span class="mf">3.1415</span><span class="p">;</span> <span class="n">n1</span><span class="o">=</span><span class="mf">1.5</span>
<span class="n">z_start</span><span class="o">=</span><span class="mf">0.001</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span> <span class="n">z_end</span><span class="o">=</span> <span class="mi">150</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span>
<span class="n">steps</span><span class="o">=</span><span class="mi">11</span><span class="p">;</span>
<span class="n">delta_z</span><span class="o">=</span><span class="p">(</span><span class="n">z_end</span><span class="o">-</span><span class="n">z_start</span><span class="p">)</span><span class="o">/</span><span class="n">steps</span>
<span class="n">z</span><span class="o">=</span><span class="n">z_start</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mf">3.5</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Axicon</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">steps</span><span class="p">):</span> 
    <span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="n">delta_z</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="n">s</span><span class="o">=</span><span class="s1">&#39;z= </span><span class="si">%3.1f</span><span class="s1"> m&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">N2</span><span class="o">-</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">+</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">-</span><span class="n">NZ</span><span class="p">,</span> <span class="n">N2</span><span class="o">+</span><span class="n">NZ</span><span class="p">])</span>
    <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">+</span><span class="n">delta_z</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/BesselBeam/BesselAxicon_01_00.png">png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAxicon_01_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/BesselBeam/BesselAxicon_01_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/BesselAxicon_01_00.png" src="_images/BesselAxicon_01_00.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="laser-examples">
<h2><span class="section-number">6.4. </span>Laser examples.<a class="headerlink" href="#laser-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="hermite-gauss-modes">
<span id="index-5"></span><h3><span class="section-number">6.4.1. </span>Hermite Gauss modes.<a class="headerlink" href="#hermite-gauss-modes" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Gauss_laser_mode.py</span>

<span class="sd">    Calculates the intensity- and phase distributions of Laguerre-Gauss</span>
<span class="sd">    (LG=True) or Hermite-Gauss (LG=False) laser modes.</span>

<span class="sd">    cc Fred van Goor, May 2020.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="k">if</span> <span class="n">LPversion</span> <span class="o">&lt;</span> <span class="s2">&quot;2.0.0&quot;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;You need to upgrade LightPipes to run this script.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;Type at a terminal prompt: $ pip install --upgrade LightPipes&#39;</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">wavelength</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">w0</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">mm</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="n">LG</span><span class="o">=</span><span class="bp">False</span>

<span class="n">n_max</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span><span class="n">m_max</span><span class="o">=</span><span class="mi">6</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">m_max</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">n_max</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.0</span><span class="p">,</span><span class="mf">7.0</span><span class="p">))</span>
<span class="k">if</span> <span class="n">LG</span><span class="p">:</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Laguerre-Gauss laser modes&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Hermite-Gauss laser modes&#39;</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m_max</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_max</span><span class="p">):</span>
        <span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">LG</span><span class="o">=</span><span class="n">LG</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
        <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
        <span class="n">Phi</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">LG</span><span class="p">:</span>
            <span class="n">s</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;$LG_{n}$&#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;$_{m}$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;$HG_{n}$&#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;$_{m}$&#39;</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Laser/Gauss_laser_mode_HG.py">Source code</a>, <a class="reference external" href="./Examples/Laser/Gauss_laser_mode_HG.png">png</a>, <a class="reference external" href="./Examples/Laser/Gauss_laser_mode_HG.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/Gauss_laser_mode_HG.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Gauss_laser_mode_HG.png" src="_images/Gauss_laser_mode_HG.png" />
</div>
</div>
<div class="section" id="laguerre-gauss-modes">
<h3><span class="section-number">6.4.2. </span>Laguerre Gauss modes.<a class="headerlink" href="#laguerre-gauss-modes" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Gauss_laser_mode.py</span>

<span class="sd">    Calculates the intensity- and phase distributions of Laguerre-Gauss</span>
<span class="sd">    (LG=True) or Hermite-Gauss (LG=False) laser modes.</span>

<span class="sd">    cc Fred van Goor, May 2020.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="k">if</span> <span class="n">LPversion</span> <span class="o">&lt;</span> <span class="s2">&quot;2.0.0&quot;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;You need to upgrade LightPipes to run this script.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;Type at a terminal prompt: $ pip install --upgrade LightPipes&#39;</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">wavelength</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">w0</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">mm</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="n">LG</span><span class="o">=</span><span class="bp">True</span>

<span class="n">n_max</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span><span class="n">m_max</span><span class="o">=</span><span class="mi">6</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">m_max</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">n_max</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.0</span><span class="p">,</span><span class="mf">7.0</span><span class="p">))</span>
<span class="k">if</span> <span class="n">LG</span><span class="p">:</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Laguerre-Gauss laser modes&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Hermite-Gauss laser modes&#39;</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m_max</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_max</span><span class="p">):</span>
        <span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">LG</span><span class="o">=</span><span class="n">LG</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
        <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
        <span class="n">Phi</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">LG</span><span class="p">:</span>
            <span class="n">s</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;$LG_{n}$&#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;$_{m}$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;$HG_{n}$&#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;$_{m}$&#39;</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Laser/Gauss_laser_mode_LG.py">Source code</a>, <a class="reference external" href="./Examples/Laser/Gauss_laser_mode_LG.png">png</a>, <a class="reference external" href="./Examples/Laser/Gauss_laser_mode_LG.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/Gauss_laser_mode_LG.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Gauss_laser_mode_LG.png" src="_images/Gauss_laser_mode_LG.png" />
</div>
</div>
<div class="section" id="laguerre-doughnut-modes">
<h3><span class="section-number">6.4.3. </span>Laguerre doughnut modes.<a class="headerlink" href="#laguerre-doughnut-modes" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GaussLaguerre_doughnut.py</span>

<span class="sd">    Calculates the intensity- and phase distributions of</span>
<span class="sd">    Laguerre-Gauss doughnut laser modes.</span>

<span class="sd">    cc Fred van Goor, May 2020.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="k">if</span> <span class="n">LPversion</span> <span class="o">&lt;</span> <span class="s2">&quot;2.0.0&quot;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;You need to upgrade LightPipes to run this script.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;Type at a terminal prompt: $ pip install --upgrade LightPipes&#39;</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">wavelength</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">w0</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">mm</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>

<span class="n">m_max</span><span class="o">=</span><span class="mi">6</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">m_max</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">))</span>
<span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Doughnut laser modes&#39;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">m_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">doughnut</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
    <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">Phi</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
    <span class="n">s</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;$LG_{n}$&#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;$_{m}$&#39;</span> <span class="o">+</span> <span class="s1">&#39;$_*$&#39;</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">);</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Laser/GaussLaguerre_doughnut.py">Source code</a>, <a class="reference external" href="./Examples/Laser/GaussLaguerre_doughnut.png">png</a>, <a class="reference external" href="./Examples/Laser/GaussLaguerre_doughnut.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/GaussLaguerre_doughnut.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/GaussLaguerre_doughnut.png" src="_images/GaussLaguerre_doughnut.png" />
</div>
</div>
<div class="section" id="laser-simulation-stable-laser-resonator">
<h3><span class="section-number">6.4.4. </span>Laser simulation, stable laser resonator.<a class="headerlink" href="#laser-simulation-stable-laser-resonator" title="Permalink to this headline">¶</a></h3>
<p>A typical laser consists of two (concave or convex) mirrors separated some distance and a gain medium mostly based on
stimulated emission. One (or both) of the mirrors is partly transmissive and when the
mirrors are well aligned and the losses are below some maximum the radiation field inside the
resonator will grow starting from noise by spontaneous emission as a function of the number of round trips. The laser intensity will be structured in
a number of resonator modes depending on the wavelength, the curvatures of and the distance between the mirrors
and especially the diameter of an intra-cavity aperture.</p>
<div class="figure align-default" id="id2">
<img alt="_images/stab_laser.png" src="_images/stab_laser.png" />
<p class="caption"><span class="caption-text">Laser resonator with gain.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>In the python script below a number of parameters can be adjusted which allows the study of several
important features of a laser. In the movie we show Q-switching to generate short high intensity pulses
by changing the reflectivity of the outcoupling mirror, operation on high-order transversal modes by opening
the aperture, changing the resonator g-parameters to study the stability criterion,
injection of a high-order Gauss-Hermite mode and the effect of thin wires inside the resonator.</p>
<iframe width="560" height="315" src="_static/laser.m4v" frameborder="0" allowfullscreen></iframe><p><a class="reference download internal" download="" href="_downloads/563e63794d70c1eb5d969b72ead4d4d7/laser_simulation.py"><code class="xref download docutils literal notranslate"><span class="pre">(Download</span> <span class="pre">source</span> <span class="pre">code)</span></code></a></p>
<div class="literal-block-wrapper docutils container" id="laser-simulation">
<div class="code-block-caption"><span class="caption-text">laser_simulation.py</span><a class="headerlink" href="#laser-simulation" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="k">import</span> <span class="n">FigureCanvasTkAgg</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">Tkinter</span> <span class="k">import</span> <span class="o">*</span>
    <span class="kn">import</span> <span class="nn">Tkinter</span> <span class="k">as</span> <span class="nn">Tk</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">tkinter</span> <span class="k">import</span> <span class="o">*</span>
    <span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">Tk</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="n">root</span><span class="o">.</span><span class="n">wm_title</span><span class="p">(</span><span class="s2">&quot;Laser with stable resonator&quot;</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">wm_protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
<span class="n">power</span><span class="o">=</span><span class="p">[]</span>
<span class="n">roundtrip</span><span class="o">=</span><span class="mi">0</span>

<span class="n">wavelength</span><span class="o">=</span><span class="mi">10600</span><span class="o">*</span><span class="n">nm</span><span class="p">;</span>
<span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="n">mm</span><span class="p">;</span>
<span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span> <span class="n">N2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Isat</span><span class="o">=</span><span class="mi">131</span><span class="o">*</span><span class="n">W</span><span class="o">/</span><span class="n">cm</span><span class="o">/</span><span class="n">cm</span><span class="p">;</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0067</span><span class="o">/</span><span class="n">cm</span><span class="p">;</span> <span class="n">Lgain</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">cm</span><span class="p">;</span>

<span class="n">f1</span><span class="o">=</span><span class="mf">2.0</span><span class="o">*</span><span class="n">m</span>
<span class="n">f2</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">m</span>

<span class="n">L</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">cm</span>
<span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">Reflect</span><span class="o">=</span><span class="mf">0.9</span><span class="p">;</span>
<span class="n">w0</span><span class="o">=</span><span class="mf">2.4</span><span class="o">*</span><span class="n">mm</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="n">tx</span><span class="o">=</span><span class="mf">0.00</span><span class="o">*</span><span class="n">mrad</span><span class="p">;</span>
<span class="n">ty</span><span class="o">=</span><span class="mf">0.00</span><span class="o">*</span><span class="n">mrad</span><span class="p">;</span>
<span class="n">xwire</span><span class="o">=</span><span class="mf">10.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">ywire</span><span class="o">=</span><span class="mf">10.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">dt</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">/</span><span class="mf">2.998</span><span class="o">*</span><span class="mf">1e-8</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>

<span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>
<span class="n">canvas</span><span class="o">.</span><span class="n">_tkcanvas</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">v</span><span class="o">=</span><span class="n">StringVar</span><span class="p">()</span>
<span class="n">v2</span><span class="o">=</span><span class="n">StringVar</span><span class="p">()</span>
<span class="n">dnt</span><span class="o">=</span><span class="n">IntVar</span><span class="p">()</span>
<span class="n">LG</span><span class="o">=</span><span class="n">IntVar</span><span class="p">()</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">TheExample</span><span class="p">():</span>
    <span class="c1">#start_time=time.time()</span>
    <span class="k">global</span> <span class="n">F</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">roundtrip</span>
    <span class="k">global</span> <span class="n">Reflect</span>
    <span class="n">w0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_w0</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mm</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">xwire</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scalexwire</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mm</span>
    <span class="n">ywire</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scaleywire</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mm</span>
    <span class="n">f1</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_f1</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">*</span><span class="n">cm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">f2</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_f2</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">*</span><span class="n">cm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">L</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_L</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">cm</span>
    <span class="n">Reflect</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_Reflect</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
    <span class="n">tx</span><span class="o">=-</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_tx</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mrad</span>
    <span class="n">ty</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_ty</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">*</span><span class="n">mrad</span>
    <span class="n">alpha</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">scale_gain</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="o">/</span><span class="n">cm</span>
    <span class="n">F</span><span class="o">=</span><span class="n">RandomIntensity</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">CircAperture</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">RectScreen</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="mf">0.2</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ywire</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">RectScreen</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="n">size</span><span class="p">,</span><span class="n">xwire</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">Iw</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">F</span><span class="p">);</span> <span class="n">F</span><span class="o">=</span><span class="n">Gain</span><span class="p">(</span><span class="n">Isat</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Lgain</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Tilt</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">F</span><span class="p">);</span> <span class="n">F</span><span class="o">=</span><span class="n">Gain</span><span class="p">(</span><span class="n">Isat</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Lgain</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
    <span class="n">F</span><span class="o">=</span><span class="n">IntAttenuator</span><span class="p">(</span><span class="n">Reflect</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">P</span><span class="o">=</span><span class="n">Power</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Reflect</span><span class="p">)</span><span class="o">*</span><span class="n">size</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="n">size</span><span class="o">/</span><span class="n">N</span>
    <span class="n">power</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">roundtrip</span><span class="o">=</span><span class="n">roundtrip</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">roundtrip</span><span class="o">&gt;</span><span class="mi">500</span><span class="p">):</span>
        <span class="n">power</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">Iout</span><span class="o">=</span><span class="n">Isat</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">Lgain</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Reflect</span><span class="p">))</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">w0</span><span class="o">*</span><span class="n">w0</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">g1</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f1</span><span class="p">);</span>
    <span class="n">g2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f2</span><span class="p">);</span>
    <span class="n">g</span><span class="o">=</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span>
    <span class="n">v</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>  <span class="s2">&quot;Power=</span><span class="si">%5.3f</span><span class="s2"> W</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">P</span><span class="o">+</span>
            <span class="s2">&quot;g1 = </span><span class="si">%5.3f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">g1</span><span class="o">+</span>
            <span class="s2">&quot;g2 = </span><span class="si">%5.3f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">g2</span><span class="o">+</span>
            <span class="s2">&quot;g  = </span><span class="si">%5.3f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">g</span>
            <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Iw</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;laser mode&#39;</span><span class="p">)</span> 
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">power</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
    <span class="n">s</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%3.1f</span><span class="s1"> ns/div&#39;</span><span class="o">%</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">L</span><span class="o">/</span><span class="mf">2.988</span><span class="o">*</span><span class="mf">1000.0</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;power [W]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
        <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>          <span class="c1"># changes apply to the x-axis</span>
        <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>      <span class="c1"># both major and minor ticks are affected</span>
        <span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span>      <span class="c1"># ticks along the bottom edge are off</span>
        <span class="n">top</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span>         <span class="c1"># ticks along the top edge are off</span>
        <span class="n">labelbottom</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="c1">#print(&quot;Execution time: --- %4.2f seconds ---&quot; % (time.time() - start_time)) </span>

<span class="k">def</span> <span class="nf">_quit</span><span class="p">():</span>
    <span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
    <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">_eigenmode</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">F</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">w0</span>
    <span class="n">g1</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f1</span><span class="p">);</span>
    <span class="n">g2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f2</span><span class="p">);</span>
    <span class="n">g</span><span class="o">=</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span>
    <span class="n">z1</span><span class="o">=</span><span class="n">L</span><span class="o">*</span><span class="n">g2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">g1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">g1</span><span class="o">+</span><span class="n">g2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="p">);</span>
    <span class="n">z2</span><span class="o">=</span><span class="n">L</span><span class="o">-</span><span class="n">z1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">g</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">w0</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">wavelength</span><span class="o">*</span><span class="n">L</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">g1</span><span class="o">+</span><span class="n">g2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span><span class="p">;</span>
    <span class="n">mode_m</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">order_m</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
    <span class="n">mode_n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">order_n</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">dnt</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
        <span class="n">m</span><span class="o">=</span><span class="n">mode_m</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">m</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">v2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Injected eigen mode: &#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;dougnut LG</span><span class="si">{m}</span><span class="s1">,</span><span class="si">{mode_n}</span><span class="s1">*&#39;</span><span class="p">)</span>
        <span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">doughnut</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">mode_n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">LG</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">LG</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">mode_m</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">mode_n</span><span class="p">)</span>
            <span class="n">v2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Injected eigen mode: &#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;Laguerre-Gauss</span><span class="si">{mode_m}</span><span class="s1">,</span><span class="si">{mode_n}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">LG</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">mode_m</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">mode_n</span><span class="p">)</span>
            <span class="n">v2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Injected eigen mode: &#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;Hermite-Gauss</span><span class="si">{mode_m}</span><span class="s1">,</span><span class="si">{mode_n}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>

<span class="n">frame1</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">frame1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame2</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame1</span><span class="p">)</span>
<span class="n">frame2</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame3</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame2</span><span class="p">)</span>
<span class="n">frame3</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame4</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame3</span><span class="p">)</span>
<span class="n">frame4</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame5</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame4</span><span class="p">)</span>
<span class="n">frame5</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame6</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame5</span><span class="p">)</span>
<span class="n">frame6</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
<span class="n">frame7</span><span class="o">=</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame6</span><span class="p">)</span>
<span class="n">frame7</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>

<span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">v2</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

<span class="n">scalexwire</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame1</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;x-wire position [mm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=-</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">scalexwire</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scalexwire</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xwire</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span>

<span class="n">scaleywire</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame1</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;y-wire position [mm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=-</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">scaleywire</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scaleywire</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ywire</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span>

<span class="n">scale_w0</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame2</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;aperture diameter [mm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">size</span><span class="o">/</span><span class="n">mm</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">scale_w0</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_w0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">w0</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span>

<span class="n">scale_Reflect</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame2</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;outcoupler reflection&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">scale_Reflect</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_Reflect</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">Reflect</span><span class="p">)</span>

<span class="n">scale_f1</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame3</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;mirror M1 radius [cm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">scale_f1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_f1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">f1</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span>

<span class="n">scale_f2</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame3</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;mirror M2 radius [cm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">scale_f2</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_f2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">f2</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span>

<span class="n">scale_L</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame4</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;resonator length [cm]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">scale_L</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_L</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span>

<span class="n">scale_gain</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame4</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;gain [cm^-1]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)</span>
<span class="n">scale_gain</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_gain</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">cm</span><span class="p">)</span>

<span class="n">scale_tx</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame5</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;mirror M2 x-tilt [mrad]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">scale_tx</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_tx</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">tx</span><span class="o">/</span><span class="n">mrad</span><span class="p">)</span>

<span class="n">scale_ty</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">frame5</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;mirror M2 y-tilt [mrad]&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">from_</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">resolution</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">scale_ty</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
<span class="n">scale_ty</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ty</span><span class="o">/</span><span class="n">mrad</span><span class="p">)</span>

<span class="n">button_eigenmode</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame6</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;eigen mode&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">_eigenmode</span><span class="p">)</span>
<span class="n">button_eigenmode</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">order_m</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">Spinbox</span><span class="p">(</span><span class="n">frame6</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">order_m</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

<span class="n">order_n</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">Spinbox</span><span class="p">(</span><span class="n">frame6</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">order_n</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">doughnut</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">frame6</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;doughnut&#39;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="n">dnt</span><span class="p">)</span>
<span class="n">doughnut</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">Laguerre</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">frame6</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Laguerre Gauss&#39;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="n">LG</span><span class="p">)</span>
<span class="n">Laguerre</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>


<span class="n">button_quit</span> <span class="o">=</span> <span class="n">Tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame7</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Quit&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">_quit</span><span class="p">)</span>
<span class="n">button_quit</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">Tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">task</span><span class="p">():</span>
    <span class="n">TheExample</span><span class="p">()</span>
    <span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">task</span><span class="p">)</span>

<span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">task</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>


</pre></div>
</div>
</div>
</div>
<div class="section" id="unstable-laser-resonator">
<h3><span class="section-number">6.4.5. </span>Unstable laser resonator.<a class="headerlink" href="#unstable-laser-resonator" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Unstable resonator.</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">wavelength</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">w</span><span class="o">=</span><span class="mf">5.48</span><span class="o">*</span><span class="n">mm</span>
<span class="n">f1</span><span class="o">=-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="n">f2</span><span class="o">=</span><span class="mf">4.0</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="n">L</span><span class="o">=</span><span class="mf">2.0</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="n">Isat</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">;</span> <span class="n">Lgain</span><span class="o">=</span><span class="mf">1e4</span><span class="p">;</span>
<span class="n">tx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span> <span class="n">ty</span><span class="o">=</span><span class="mf">0.00000</span><span class="p">;</span>
<span class="n">Nrndtrips</span><span class="o">=</span><span class="mi">20</span>

<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">SR</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nrndtrips</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">F</span><span class="o">=</span><span class="n">RandomIntensity</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span><span class="mi">1000</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">RandomPhase</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span><span class="mi">10</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;{0} {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;roundtrip&#39;</span><span class="p">,</span> <span class="s1">&#39;Strehl ratio&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Nrndtrips</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
   <span class="n">F</span><span class="o">=</span><span class="n">RectAperture</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">Gain</span><span class="p">(</span><span class="n">Isat</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">Lgain</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">LensFresnel</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">LensFresnel</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">Tilt</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">SR</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">Strehl</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">F</span><span class="o">=</span><span class="n">Interpol</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="k">print</span><span class="p">(</span><span class="s1">&#39;  {0:2d}          {1:0.3f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">SR</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
   <span class="n">F2</span><span class="o">=</span><span class="n">RectScreen</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">F2</span><span class="p">);</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Nrndtrips</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Convert</span><span class="p">(</span><span class="n">F2</span><span class="p">);</span>
<span class="n">i</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">j</span><span class="o">=</span><span class="n">i</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="n">I</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Near-field intensity distribution&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">Nrndtrips</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SR</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nrndtrips</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Strehl ratio&#39;</span><span class="p">)</span>

<span class="c1">#Far-field calculation:</span>
<span class="n">z</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="n">f</span><span class="o">=</span><span class="mf">4.0</span><span class="o">*</span><span class="n">m</span><span class="p">;</span>
<span class="n">ff</span><span class="o">=</span><span class="n">z</span><span class="o">*</span><span class="n">f</span><span class="o">/</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">z</span><span class="p">);</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Lens</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F2</span><span class="p">);</span>
<span class="n">F2</span><span class="o">=</span><span class="n">LensFresnel</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">F2</span><span class="p">);</span>
<span class="n">F2</span><span class="o">=</span><span class="n">Convert</span><span class="p">(</span><span class="n">F2</span><span class="p">);</span>
<span class="n">I2</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">F2</span><span class="p">);</span>
<span class="n">I2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">I2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Far-field intensity distribution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Laser/unstable_resonator.py">Source code</a>)</p>
<div class="figure align-default" id="id3">
<img alt="_images/unstable_resonator_00.png" src="_images/unstable_resonator_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="./Examples/Laser/unstable_resonator_00.png">png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_00.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_00.pdf">pdf</a>)</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id4">
<img alt="_images/unstable_resonator_01.png" src="_images/unstable_resonator_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="./Examples/Laser/unstable_resonator_01.png">png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_01.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_01.pdf">pdf</a>)</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id5">
<img alt="_images/unstable_resonator_02.png" src="_images/unstable_resonator_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="./Examples/Laser/unstable_resonator_02.png">png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_02.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_02.pdf">pdf</a>)</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<img alt="_images/unstable_resonator_03.png" src="_images/unstable_resonator_03.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="./Examples/Laser/unstable_resonator_03.png">png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_03.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/unstable_resonator_03.pdf">pdf</a>)</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="transformation-of-a-fundamental-gauss-mode-into-a-doughnut-mode-with-a-spiral-phase-plate">
<h3><span class="section-number">6.4.6. </span>Transformation of a fundamental Gauss mode into a doughnut mode with a spiral phase plate.<a class="headerlink" href="#transformation-of-a-fundamental-gauss-mode-into-a-doughnut-mode-with-a-spiral-phase-plate" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Spiral_phase_plate.py</span>

<span class="sd">    Transforms a Gauss beam into a Gauss doughnut beam.</span>

<span class="sd">    cc Fred van Goor, May 2020.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="k">if</span> <span class="n">LPversion</span> <span class="o">&lt;</span> <span class="s2">&quot;2.0.0&quot;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;You need to upgrade LightPipes to run this script.&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;Type at a terminal prompt: $ pip install --upgrade LightPipes&#39;</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">wavelength</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">501</span>
<span class="n">w0</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">mm</span>
<span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">cm</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">GaussBeam</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w0</span><span class="p">)</span>
<span class="n">Iin</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">PhaseSpiral</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
<span class="n">phase</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">unwrap</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Fresnel</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;LightPipes for Python,&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> <span class="s1">&#39;Spiral_phase_plate.py&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$\lambda = {:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wavelength</span><span class="o">/</span><span class="n">nm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $nm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$size = {:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $mm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$N = {:4d}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$w_0 = {:4.2f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w0</span><span class="o">/</span><span class="n">mm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $mm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$z = $&#39;</span> <span class="o">+</span> <span class="s1">&#39;{:4.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">cm</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $cm$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;$order = $&#39;</span> <span class="o">+</span> <span class="s1">&#39;{:2d}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>\
    <span class="sa">r</span><span class="s1">&#39;${\copyright}$ Fred van Goor, May 2020&#39;</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">_axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.0</span><span class="p">,</span><span class="mf">6.5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Gauss beam transformation to doughnut with spiral phase plate&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">_axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Iin</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;intensity at z = 0 cm&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;intensity at z = {z/cm} cm&#39;</span><span class="p">)</span>

<span class="n">img1</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;phase distribution of the spiral phase plate&#39;</span>\
                 <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">f</span><span class="s1">&#39; with order {order}&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">PI</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">],</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;$\pi$&#39;</span><span class="p">,</span> <span class="s1">&#39;$2\pi$&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Laser/Spiral_phase_plate.py">Source code</a>, <a class="reference external" href="./Examples/Laser/Spiral_phase_plate.png">png</a>, <a class="reference external" href="./Examples/Laser/Spiral_phase_plate.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Laser/Spiral_phase_plate.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Spiral_phase_plate.png" src="_images/Spiral_phase_plate.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="phase-recovery">
<h2><span class="section-number">6.5. </span>Phase recovery.<a class="headerlink" href="#phase-recovery" title="Permalink to this headline">¶</a></h2>
<div class="section" id="phase-recovery-using-gerchberg-saxton-iteration">
<span id="index-6"></span><h3><span class="section-number">6.5.1. </span>Phase recovery using Gerchberg Saxton iteration.<a class="headerlink" href="#phase-recovery-using-gerchberg-saxton-iteration" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Phase recovery from two measured intensity distributions using Gerchberg Saxton.</span>

<span class="sd">..  :copyright: (c) 2017 by Fred van Goor.</span>
<span class="sd">    :license: MIT, see License for more details.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">print</span><span class="p">(</span><span class="n">LPversion</span><span class="p">)</span>
<span class="c1">#Parameters used for the experiment:</span>
<span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="o">*</span><span class="n">mm</span><span class="p">;</span> <span class="c1">#The CCD-sensor has an area of size x size (NB LightPipes needs square grids!)</span>
<span class="n">wavelength</span><span class="o">=</span><span class="mf">632.8</span><span class="o">*</span><span class="n">nm</span><span class="p">;</span> <span class="c1">#wavelength of the HeNe laser used</span>
<span class="n">z</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">;</span> <span class="c1">#propagation distance from near to far field</span>
<span class="n">N_iterations</span><span class="o">=</span><span class="mi">300</span> <span class="c1">#number of iterations</span>

<span class="c1">#Read near and far field (at a distance of z=2 m) from disk:</span>
<span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Inear.prn&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">lines</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
<span class="n">Inear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Ifar.prn&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">lines</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
<span class="n">Ifar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">N</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Inear</span><span class="p">)</span>
<span class="n">N_new</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span><span class="n">size_new</span><span class="o">=</span><span class="mi">40</span><span class="o">*</span><span class="n">mm</span><span class="p">;</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Inear</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Measured Intensity near field&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span> <span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Ifar</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Measured Intensity far field&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span> <span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>

<span class="c1">#Define a field with uniform amplitude- (=1) and phase (=0) distribution</span>
<span class="c1">#(= plane wave)</span>
<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>

<span class="c1">#The iteration:</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">SubIntensity</span><span class="p">(</span><span class="n">Ifar</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="c1">#Substitute the measured far field into the field</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Interpol</span><span class="p">(</span><span class="n">size_new</span><span class="p">,</span><span class="n">N_new</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">F</span><span class="p">);</span><span class="c1">#interpolate to a new grid</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="c1">#Propagate back to the near field</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Interpol</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="c1">#interpolate to the original grid</span>
    <span class="n">F</span><span class="o">=</span><span class="n">SubIntensity</span><span class="p">(</span><span class="n">Inear</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="c1">#Substitute the measured near field into the field</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="c1">#Propagate to the far field</span>

<span class="c1">#The recovered far- and near field and their phase- and intensity</span>
<span class="c1">#distributions (phases are unwrapped (i.e. remove multiples of PI)):</span>
<span class="n">Ffar_rec</span><span class="o">=</span><span class="n">F</span><span class="p">;</span>
<span class="n">Ifar_rec</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Ffar_rec</span><span class="p">);</span> <span class="n">Phase_far_rec</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">Ffar_rec</span><span class="p">);</span>

<span class="n">Phase_far_rec</span><span class="o">=</span><span class="n">PhaseUnwrap</span><span class="p">(</span><span class="n">Phase_far_rec</span><span class="p">)</span>
<span class="n">Fnear_rec</span><span class="o">=</span><span class="n">Forvard</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
<span class="n">Inear_rec</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Fnear_rec</span><span class="p">);</span> <span class="n">Phase_near_rec</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">Fnear_rec</span><span class="p">);</span>

<span class="n">Phase_near_rec</span><span class="o">=</span><span class="n">PhaseUnwrap</span><span class="p">(</span><span class="n">Phase_near_rec</span><span class="p">)</span>
<span class="c1">#Plot the recovered intensity- and phase distributions:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Inear_rec</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recovered Intensity near field&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span> <span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Ifar_rec</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recovered Intensity far field&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span> <span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Phase_near_rec</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recovered phase near field&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span> <span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Phase_far_rec</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recovered phase far field&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span> <span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/PhaseRecovery/PhaseRecovery.py">Source code</a>, <a class="reference external" href="./Examples/PhaseRecovery/PhaseRecovery.png">png</a>, <a class="reference external" href="./Examples/PhaseRecovery/PhaseRecovery.hires.png">hires.png</a>, <a class="reference external" href="./Examples/PhaseRecovery/PhaseRecovery.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/PhaseRecovery.png" src="_images/PhaseRecovery.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zernike-aberration">
<h2><span class="section-number">6.6. </span>Zernike aberration.<a class="headerlink" href="#zernike-aberration" title="Permalink to this headline">¶</a></h2>
<p>Any aberration in a circle can be decomposed over a sum of Zernike
polynomials. The Zernike command accepts four arguments:
1. The radial order n  2. The
azimuthal order m. 3. The radius, R 4. The
amplitude of the aberration.</p>
<div class="highlight-python notranslate" id="index-7"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This example demonstrates the Zernike command.</span>
<span class="sd">..  :copyright: (c) 2017 by Fred van Goor.</span>
<span class="sd">    :license: MIT, see License for more details.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">wavelength</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span><span class="o">=</span><span class="mf">2.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">200</span>
<span class="n">A</span><span class="o">=</span><span class="n">wavelength</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> 
<span class="k">for</span> <span class="n">Noll</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">22</span><span class="p">):</span>
    <span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="n">mz</span><span class="p">)</span><span class="o">=</span><span class="n">noll_to_zern</span><span class="p">(</span><span class="n">Noll</span><span class="p">)</span>
    <span class="n">S</span><span class="o">=</span><span class="n">ZernikeName</span><span class="p">(</span><span class="n">Noll</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">Zernike</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="n">CircAperture</span><span class="p">(</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
    <span class="n">Phi</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="n">Noll</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">Noll</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;  &#39;</span> <span class="o">+</span> <span class="s1">&#39; $Z^{&#39;</span><span class="o">+</span><span class="nb">repr</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}_{&#39;</span><span class="o">+</span><span class="nb">repr</span><span class="p">(</span><span class="n">nz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">S</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Zernike/Zernike.py">Source code</a>, <a class="reference external" href="./Examples/Zernike/Zernike.png">png</a>, <a class="reference external" href="./Examples/Zernike/Zernike.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Zernike/Zernike.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/Zernike.png" src="_images/Zernike.png" />
</div>
<div class="section" id="radial-shear-interferometer">
<h3><span class="section-number">6.6.1. </span>Radial shear interferometer.<a class="headerlink" href="#radial-shear-interferometer" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This example demonstrates a radial shear interferometer.</span>
<span class="sd">Only a &#39;bare-bone&#39; model, so no propagation and diffraction, is considered.</span>
<span class="sd">..  :copyright: (c) 2017 by Fred van Goor.</span>
<span class="sd">    :license: MIT, see License for more details.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">LightPipes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">pi</span><span class="o">=</span><span class="mf">3.1415</span>


<span class="n">wavelength</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="n">nm</span>
<span class="n">size</span><span class="o">=</span><span class="mf">40.0</span><span class="o">*</span><span class="n">mm</span>
<span class="n">N</span><span class="o">=</span><span class="mi">200</span>
<span class="n">R</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span>
<span class="n">nz</span><span class="o">=</span><span class="mi">10</span>
<span class="n">mz</span><span class="o">=</span><span class="mi">4</span>
<span class="n">Rz</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">mm</span>

<span class="n">Az</span><span class="o">=</span><span class="n">wavelength</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>

<span class="n">Rbs</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">M</span><span class="o">=</span><span class="mf">1.5</span>

<span class="n">F</span><span class="o">=</span><span class="n">Begin</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>

<span class="n">F</span><span class="o">=</span><span class="n">Zernike</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">Rz</span><span class="p">,</span><span class="n">Az</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">CircAperture</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">phi</span><span class="o">=</span><span class="n">Phase</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;radial shear interferometer&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;phase distribution input beam&#39;</span><span class="p">)</span>
<span class="n">F1</span><span class="o">=</span><span class="n">IntAttenuator</span><span class="p">(</span><span class="n">Rbs</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">F2</span><span class="o">=</span><span class="n">IntAttenuator</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Rbs</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>

<span class="n">F1</span><span class="o">=</span><span class="n">Interpol</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">F1</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">BeamMix</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="n">I</span><span class="o">=</span><span class="n">Intensity</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;intensity distribution output beam&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./Examples/Zernike/rad_shear.py">Source code</a>, <a class="reference external" href="./Examples/Zernike/rad_shear.png">png</a>, <a class="reference external" href="./Examples/Zernike/rad_shear.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Zernike/rad_shear.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/rad_shear.png" src="_images/rad_shear.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="graded-index-media-grin">
<h2><span class="section-number">6.7. </span>Graded index media GRIN.<a class="headerlink" href="#graded-index-media-grin" title="Permalink to this headline">¶</a></h2>
<div class="section" id="demonstration-of-a-grin-lens">
<h3><span class="section-number">6.7.1. </span>Demonstration of a GRIN lens.<a class="headerlink" href="#demonstration-of-a-grin-lens" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference external" href="./Examples/Waveguide/GRIN_demo.py">Source code</a>, <a class="reference external" href="./Examples/Waveguide/GRIN_demo.png">png</a>, <a class="reference external" href="./Examples/Waveguide/GRIN_demo.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Waveguide/GRIN_demo.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/GRIN_demo.png" src="_images/GRIN_demo.png" />
</div>
</div>
<div class="section" id="young-s-experiment-with-grin-lens">
<h3><span class="section-number">6.7.2. </span>Young’s experiment with GRIN lens.<a class="headerlink" href="#young-s-experiment-with-grin-lens" title="Permalink to this headline">¶</a></h3>
<p>(<a class="reference external" href="./Examples/Waveguide/GRIN_Young.py">Source code</a>, <a class="reference external" href="./Examples/Waveguide/GRIN_Young.png">png</a>, <a class="reference external" href="./Examples/Waveguide/GRIN_Young.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Waveguide/GRIN_Young.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/GRIN_Young.png" src="_images/GRIN_Young.png" />
</div>
</div>
<div class="section" id="propagation-in-a-lens-like-absorptive-medium">
<h3><span class="section-number">6.7.3. </span>Propagation in a lens-like, absorptive medium.<a class="headerlink" href="#propagation-in-a-lens-like-absorptive-medium" title="Permalink to this headline">¶</a></h3>
<p>In this example we model the propagation of a Gaussian beam in a lens-like waveguide. The profile of the refractive index is chosen such, that the beam preserves approximately its diameter in the waveguide (we use the fundamental mode). We’ll consider the propagation of an axial mode, tilted with respect to the waveguide axis and a non-axial mode.</p>
<p>we use the approximation for the profile of the refractive coefficient, <span class="math notranslate nohighlight">\(n'=n-i\kappa\)</span> in the form: <span class="math notranslate nohighlight">\(n(r)^2=n_0^2-n_0n_1r^2\)</span>. It is a well-known fact <a class="footnote-reference brackets" href="#f9" id="id1">1</a> that the half-width of the fundamental Gaussian mode of a lens-like waveguide is defined as: <span class="math notranslate nohighlight">\(w_0^2=\frac{2}{k(n_0n_1)^{1/2}}\)</span> , with <span class="math notranslate nohighlight">\(k=\frac{2 \pi}{\lambda}\)</span>. For a waveguide of <span class="math notranslate nohighlight">\(1 \times 1 mm,  n_0=1.5,  n_1=400 m^{-2}, \kappa = 1.0\)</span> and <span class="math notranslate nohighlight">\(\lambda = 1 \mu m\)</span>, the Gaussian mode has a diameter of <span class="math notranslate nohighlight">\(226 \mu m\)</span> . A tilt in the x-direction causes reflections in the waveguide as  demonstrated in the next example of the propagation of a tilted Gaussian beam through the waveguide.</p>
<p>(<a class="reference external" href="./Examples/Waveguide/LensLikeMedium.py">Source code</a>, <a class="reference external" href="./Examples/Waveguide/LensLikeMedium.png">png</a>, <a class="reference external" href="./Examples/Waveguide/LensLikeMedium.hires.png">hires.png</a>, <a class="reference external" href="./Examples/Waveguide/LensLikeMedium.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/LensLikeMedium.png" src="_images/LensLikeMedium.png" />
</div>
<p><em>Propagation of a tilted Gaussian beam in a lens-like, absorptive medium.</em></p>
<dl class="footnote brackets">
<dt class="label" id="f9"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><ol class="upperalpha simple" start="4">
<li><p>Marcuse, Light Transmission Optics, Van Nostrand Reinhold, 267-280, (1972).</p></li>
</ol>
</dd>
</dl>
</div>
</div>
<hr class="docutils" />
<div class="section" id="fourier-optics">
<h2><span class="section-number">6.8. </span>Fourier optics.<a class="headerlink" href="#fourier-optics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pattern-recognition">
<h3><span class="section-number">6.8.1. </span>Pattern recognition.<a class="headerlink" href="#pattern-recognition" title="Permalink to this headline">¶</a></h3>
<p>In this example we demonstrate the recognition of objects using Fourier optics.
The light, originating from a collection of objects, is focused with a positive lens. A second lens is positioned with its primary focal point in the focus of
the first lens. When we place a screen behind the second lens at its secondary focus an inverted image of the collection of objects is projected on the
screen, as shown in figure 1. The object to be recognized is present once or several times in the collection. As objects we choose
transparencies with the characters A, B, and C.</p>
<div class="figure align-default" id="id7">
<img alt="_images/setup1.png" src="_images/setup1.png" />
<p class="caption"><span class="caption-text"><em>Fig. 1 Imaging a transparency with objects</em></span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>Each object will contribute to the phase distribution in the secondary focus of the first lens. If the fluctuations in the wavefront coming from one of the
objects is compensated by a phase plate prepared for that sort of object, see figure 2, placed in the focus, the beam coming from those objects will propagate as a
diverging spherical wave to the second lens and will be focused in a diffraction limited point on the screen. The position of that point will indicate the
presence and the position of the object. This will only be the case when the object, for which the phase plate was positioned in the focus, is actually present in the collection.</p>
<div class="figure align-default" id="id8">
<img alt="_images/setup2.png" src="_images/setup2.png" />
<p class="caption"><span class="caption-text"><em>Fig. 2 Making a phase mask of the Fourier transform of an object</em></span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id9">
<img alt="_images/setup3.png" src="_images/setup3.png" />
<p class="caption"><span class="caption-text"><em>Fig. 3 Placing the phase mask in the focus of the first lens.</em></span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>(<a class="reference external" href="./Examples/FourierOptics/PatternRecognition.py">Source code</a>, <a class="reference external" href="./Examples/FourierOptics/PatternRecognition.png">png</a>, <a class="reference external" href="./Examples/FourierOptics/PatternRecognition.hires.png">hires.png</a>, <a class="reference external" href="./Examples/FourierOptics/PatternRecognition.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/PatternRecognition.png" src="_images/PatternRecognition.png" />
</div>
<p><em>Fig. 4 Results of the pattern recognition simulation.</em></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="computerprac.html" class="btn btn-neutral float-right" title="7. Computer practical." accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="manual.html" class="btn btn-neutral float-left" title="5. Manual." accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Fred van Goor
      <span class="lastupdated">
        Last updated on May 28, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>